++++++++++++++++++++++++++++++++++++++++++++++PUT++++++++++++++++++++++++++++++++++++++++++++++++++

Параллельно нагружаем кластер из трех нод одинаковой нагрузкой

1. Нода на 8084 ПОРТУ:

wrk -t4 -c4 -d60s -R1000 -s ./wrk/put.lua --latency http://localhost:8084
Running 1m test @ http://localhost:8084
  4 threads and 4 connections
  Thread calibration: mean lat.: 1.049ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.026ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.018ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.008ms, rate sampling interval: 10ms
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     1.03ms  447.33us  12.90ms   81.96%
    Req/Sec   262.29     54.34   600.00     52.23%
  Latency Distribution (HdrHistogram - Recorded Latency)
 50.000%    1.01ms
 75.000%    1.26ms
 90.000%    1.44ms
 99.000%    1.82ms
 99.900%    6.45ms
 99.990%   11.06ms
 99.999%   12.91ms
100.000%   12.91ms

  Detailed Percentile spectrum:
       Value   Percentile   TotalCount 1/(1-Percentile)

       0.201     0.000000            1         1.00
       0.580     0.100000         5015         1.11
       0.702     0.200000        10028         1.25
       0.807     0.300000        15034         1.43
       0.908     0.400000        20037         1.67
       1.009     0.500000        25031         2.00
       1.060     0.550000        27532         2.22
       1.111     0.600000        30044         2.50
       1.162     0.650000        32527         2.86
       1.213     0.700000        35063         3.33
       1.264     0.750000        37524         4.00
       1.290     0.775000        38772         4.44
       1.316     0.800000        40001         5.00
       1.344     0.825000        41269         5.71
       1.374     0.850000        42499         6.67
       1.407     0.875000        43755         8.00
       1.425     0.887500        44387         8.89
       1.444     0.900000        45020        10.00
       1.465     0.912500        45654        11.43
       1.487     0.925000        46246        13.33
       1.514     0.937500        46873        16.00
       1.529     0.943750        47201        17.78
       1.544     0.950000        47496        20.00
       1.561     0.956250        47815        22.86
       1.581     0.962500        48122        26.67
       1.603     0.968750        48444        32.00
       1.617     0.971875        48598        35.56
       1.632     0.975000        48748        40.00
       1.650     0.978125        48911        45.71
       1.670     0.981250        49062        53.33
       1.700     0.984375        49220        64.00
       1.719     0.985938        49291        71.11
       1.745     0.987500        49372        80.00
       1.784     0.989062        49448        91.43
       1.861     0.990625        49526       106.67
       1.997     0.992188        49604       128.00
       2.095     0.992969        49643       142.22
       2.227     0.993750        49682       160.00
       2.413     0.994531        49721       182.86
       2.611     0.995313        49760       213.33
       2.889     0.996094        49799       256.00
       2.991     0.996484        49819       284.44
       3.097     0.996875        49838       320.00
       3.365     0.997266        49858       365.71
       3.651     0.997656        49877       426.67
       4.239     0.998047        49897       512.00
       4.551     0.998242        49907       568.89
       5.007     0.998437        49916       640.00
       5.667     0.998633        49926       731.43
       6.167     0.998828        49936       853.33
       6.483     0.999023        49946      1024.00
       6.663     0.999121        49951      1137.78
       7.063     0.999219        49955      1280.00
       7.543     0.999316        49960      1462.86
       7.779     0.999414        49965      1706.67
       8.171     0.999512        49970      2048.00
       8.447     0.999561        49973      2275.56
       9.183     0.999609        49975      2560.00
       9.295     0.999658        49977      2925.71
       9.351     0.999707        49980      3413.33
       9.951     0.999756        49982      4096.00
      10.103     0.999780        49984      4551.11
      10.207     0.999805        49985      5120.00
      10.255     0.999829        49986      5851.43
      10.311     0.999854        49987      6826.67
      10.479     0.999878        49988      8192.00
      11.055     0.999890        49989      9102.22
      11.439     0.999902        49990     10240.00
      11.439     0.999915        49990     11702.86
      11.831     0.999927        49991     13653.33
      11.831     0.999939        49991     16384.00
      11.855     0.999945        49992     18204.44
      11.855     0.999951        49992     20480.00
      11.855     0.999957        49992     23405.71
      12.239     0.999963        49993     27306.67
      12.239     0.999969        49993     32768.00
      12.239     0.999973        49993     36408.89
      12.239     0.999976        49993     40960.00
      12.239     0.999979        49993     46811.43
      12.911     0.999982        49994     54613.33
      12.911     1.000000        49994          inf
#[Mean    =        1.028, StdDeviation   =        0.447]
#[Max     =       12.904, Total count    =        49994]
#[Buckets =           27, SubBuckets     =         2048]
----------------------------------------------------------
  60004 requests in 1.00m, 4.75MB read
Requests/sec:   1000.04
Transfer/sec:     81.06KB
arman-sh@arman-sh:/media/arman-sh/HDD/technopolis/highload/2019-highload-dht$ wrk -t4 -c4 -d120s -R10000 -s ./wrk/put.lua --latency http://localhost:8084
Running 2m test @ http://localhost:8084
  4 threads and 4 connections
  Thread calibration: mean lat.: 1.700ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 15.377ms, rate sampling interval: 96ms
  Thread calibration: mean lat.: 1522.708ms, rate sampling interval: 6844ms
  Thread calibration: mean lat.: 1439.944ms, rate sampling interval: 6840ms
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency    31.22s    17.06s    1.07m    57.64%
    Req/Sec     2.88     57.54     1.47k    99.74%
  Latency Distribution (HdrHistogram - Recorded Latency)
 50.000%   32.44s 
 75.000%   45.22s 
 90.000%    0.91m 
 99.000%    1.07m 
 99.900%    1.07m 
 99.990%    1.07m 
 99.999%    1.07m 
100.000%    1.07m 


2. НОДА на 8083 порту

wrk -t4 -c4 -d60s -R1000 -s ./wrk/put.lua --latency http://localhost:8083
Running 1m test @ http://localhost:8083
  4 threads and 4 connections
  Thread calibration: mean lat.: 1.053ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.011ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 0.983ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.004ms, rate sampling interval: 10ms
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     1.01ms  756.12us  27.57ms   97.72%
    Req/Sec   263.72     56.03     0.90k    56.92%
  Latency Distribution (HdrHistogram - Recorded Latency)
 50.000%    0.96ms
 75.000%    1.22ms
 90.000%    1.42ms
 99.000%    2.28ms
 99.900%   12.36ms
 99.990%   23.33ms
 99.999%   27.58ms
100.000%   27.58ms

  Detailed Percentile spectrum:
       Value   Percentile   TotalCount 1/(1-Percentile)

       0.165     0.000000            1         1.00
       0.517     0.100000         5012         1.11
       0.653     0.200000        10003         1.25
       0.762     0.300000        15034         1.43
       0.864     0.400000        20032         1.67
       0.965     0.500000        25034         2.00
       1.014     0.550000        27498         2.22
       1.062     0.600000        29997         2.50
       1.111     0.650000        32517         2.86
       1.172     0.700000        34998         3.33
       1.224     0.750000        37528         4.00
       1.250     0.775000        38746         4.44
       1.280     0.800000        40035         5.00
       1.310     0.825000        41274         5.71
       1.343     0.850000        42519         6.67
       1.378     0.875000        43770         8.00
       1.395     0.887500        44374         8.89
       1.416     0.900000        45016        10.00
       1.440     0.912500        45630        11.43
       1.465     0.925000        46247        13.33
       1.499     0.937500        46885        16.00
       1.522     0.943750        47189        17.78
       1.548     0.950000        47497        20.00
       1.574     0.956250        47808        22.86
       1.601     0.962500        48125        26.67
       1.636     0.968750        48435        32.00
       1.659     0.971875        48594        35.56
       1.688     0.975000        48748        40.00
       1.726     0.978125        48902        45.71
       1.771     0.981250        49059        53.33
       1.843     0.984375        49213        64.00
       1.915     0.985938        49291        71.11
       2.049     0.987500        49370        80.00
       2.185     0.989062        49448        91.43
       2.347     0.990625        49526       106.67
       2.617     0.992188        49604       128.00
       2.809     0.992969        49644       142.22
       3.039     0.993750        49682       160.00
       3.419     0.994531        49721       182.86
       4.063     0.995313        49760       213.33
       5.111     0.996094        49799       256.00
       5.595     0.996484        49819       284.44
       5.911     0.996875        49838       320.00
       6.663     0.997266        49858       365.71
       7.911     0.997656        49877       426.67
       8.927     0.998047        49897       512.00
       9.439     0.998242        49907       568.89
      10.175     0.998437        49916       640.00
      10.783     0.998633        49926       731.43
      11.807     0.998828        49936       853.33
      12.415     0.999023        49946      1024.00
      12.615     0.999121        49951      1137.78
      13.679     0.999219        49955      1280.00
      14.191     0.999316        49960      1462.86
      15.183     0.999414        49965      1706.67
      15.743     0.999512        49970      2048.00
      16.287     0.999561        49973      2275.56
      16.975     0.999609        49975      2560.00
      18.063     0.999658        49977      2925.71
      19.231     0.999707        49980      3413.33
      19.679     0.999756        49982      4096.00
      20.351     0.999780        49984      4551.11
      21.567     0.999805        49985      5120.00
      21.599     0.999829        49986      5851.43
      22.079     0.999854        49987      6826.67
      22.687     0.999878        49988      8192.00
      23.327     0.999890        49989      9102.22
      24.143     0.999902        49990     10240.00
      24.143     0.999915        49990     11702.86
      24.399     0.999927        49991     13653.33
      24.399     0.999939        49991     16384.00
      25.711     0.999945        49992     18204.44
      25.711     0.999951        49992     20480.00
      25.711     0.999957        49992     23405.71
      26.207     0.999963        49993     27306.67
      26.207     0.999969        49993     32768.00
      26.207     0.999973        49993     36408.89
      26.207     0.999976        49993     40960.00
      26.207     0.999979        49993     46811.43
      27.583     0.999982        49994     54613.33
      27.583     1.000000        49994          inf
#[Mean    =        1.014, StdDeviation   =        0.756]
#[Max     =       27.568, Total count    =        49994]
#[Buckets =           27, SubBuckets     =         2048]
----------------------------------------------------------
  60004 requests in 1.00m, 4.75MB read
Requests/sec:   1000.05
Transfer/sec:     81.06KB






3. НОДА на 8085 ПОРТУ

wrk -t4 -c4 -d60s -R1000 -s ./wrk/put.lua --latency http://localhost:8085
Running 1m test @ http://localhost:8085
  4 threads and 4 connections
  Thread calibration: mean lat.: 1.026ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.018ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.051ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.072ms, rate sampling interval: 10ms
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     1.03ms  427.61us  15.26ms   79.55%
    Req/Sec   262.56     54.61   666.00     50.63%
  Latency Distribution (HdrHistogram - Recorded Latency)
 50.000%    1.02ms
 75.000%    1.27ms
 90.000%    1.45ms
 99.000%    1.78ms
 99.900%    5.63ms
 99.990%   11.97ms
 99.999%   15.27ms
100.000%   15.27ms

  Detailed Percentile spectrum:
       Value   Percentile   TotalCount 1/(1-Percentile)

       0.136     0.000000            1         1.00
       0.587     0.100000         5011         1.11
       0.712     0.200000        10002         1.25
       0.818     0.300000        15028         1.43
       0.919     0.400000        20009         1.67
       1.021     0.500000        25029         2.00
       1.071     0.550000        27511         2.22
       1.122     0.600000        30025         2.50
       1.173     0.650000        32506         2.86
       1.222     0.700000        35008         3.33
       1.274     0.750000        37539         4.00
       1.299     0.775000        38761         4.44
       1.325     0.800000        40010         5.00
       1.353     0.825000        41251         5.71
       1.382     0.850000        42505         6.67
       1.415     0.875000        43793         8.00
       1.431     0.887500        44398         8.89
       1.449     0.900000        44999        10.00
       1.470     0.912500        45628        11.43
       1.491     0.925000        46255        13.33
       1.516     0.937500        46878        16.00
       1.530     0.943750        47184        17.78
       1.546     0.950000        47518        20.00
       1.561     0.956250        47819        22.86
       1.579     0.962500        48120        26.67
       1.600     0.968750        48441        32.00
       1.613     0.971875        48594        35.56
       1.625     0.975000        48745        40.00
       1.640     0.978125        48905        45.71
       1.663     0.981250        49058        53.33
       1.690     0.984375        49218        64.00
       1.708     0.985938        49293        71.11
       1.731     0.987500        49372        80.00
       1.762     0.989062        49448        91.43
       1.801     0.990625        49527       106.67
       1.882     0.992188        49604       128.00
       1.940     0.992969        49643       142.22
       2.019     0.993750        49683       160.00
       2.099     0.994531        49721       182.86
       2.227     0.995313        49760       213.33
       2.427     0.996094        49799       256.00
       2.559     0.996484        49819       284.44
       2.781     0.996875        49838       320.00
       3.037     0.997266        49858       365.71
       3.263     0.997656        49878       426.67
       3.847     0.998047        49897       512.00
       3.999     0.998242        49907       568.89
       4.191     0.998437        49916       640.00
       4.535     0.998633        49927       731.43
       4.883     0.998828        49936       853.33
       5.743     0.999023        49946      1024.00
       5.919     0.999121        49951      1137.78
       6.339     0.999219        49955      1280.00
       6.843     0.999316        49960      1462.86
       7.183     0.999414        49965      1706.67
       7.607     0.999512        49970      2048.00
       7.787     0.999561        49973      2275.56
       8.063     0.999609        49975      2560.00
       8.255     0.999658        49977      2925.71
       8.511     0.999707        49980      3413.33
       8.991     0.999756        49982      4096.00
       9.719     0.999780        49984      4551.11
       9.895     0.999805        49985      5120.00
      10.351     0.999829        49986      5851.43
      10.751     0.999854        49987      6826.67
      11.591     0.999878        49988      8192.00
      11.967     0.999890        49989      9102.22
      11.991     0.999902        49990     10240.00
      11.991     0.999915        49990     11702.86
      12.791     0.999927        49991     13653.33
      12.791     0.999939        49991     16384.00
      13.447     0.999945        49992     18204.44
      13.447     0.999951        49992     20480.00
      13.447     0.999957        49992     23405.71
      13.751     0.999963        49993     27306.67
      13.751     0.999969        49993     32768.00
      13.751     0.999973        49993     36408.89
      13.751     0.999976        49993     40960.00
      13.751     0.999979        49993     46811.43
      15.271     0.999982        49994     54613.33
      15.271     1.000000        49994          inf
#[Mean    =        1.034, StdDeviation   =        0.428]
#[Max     =       15.264, Total count    =        49994]
#[Buckets =           27, SubBuckets     =         2048]
----------------------------------------------------------
  60004 requests in 1.00m, 4.75MB read
Requests/sec:   1000.05
Transfer/sec:     81.06KB



++++++++++++++++++++++++++++++++++++++++++GET++++++++++++++++++++++++++++++++++++++++++++++++++++++


Параллельно нагружаем кластер из трех нод одинаковой нагрузкой:

1. НОДА НА ПОРТУ 8085

 wrk -t4 -c4 -d60s -R1000 -s ./wrk/get.lua --latency http://localhost:8085
Running 1m test @ http://localhost:8085
  4 threads and 4 connections
  Thread calibration: mean lat.: 1.006ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.043ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.026ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 0.992ms, rate sampling interval: 10ms
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     1.00ms  650.89us  20.59ms   94.73%
    Req/Sec   264.19     55.31   700.00     55.94%
  Latency Distribution (HdrHistogram - Recorded Latency)
 50.000%    0.95ms
 75.000%    1.21ms
 90.000%    1.41ms
 99.000%    2.43ms
 99.900%   10.02ms
 99.990%   16.91ms
 99.999%   20.61ms
100.000%   20.61ms

  Detailed Percentile spectrum:
       Value   Percentile   TotalCount 1/(1-Percentile)

       0.108     0.000000            1         1.00
       0.508     0.100000         5023         1.11
       0.637     0.200000        10008         1.25
       0.747     0.300000        15025         1.43
       0.852     0.400000        20037         1.67
       0.953     0.500000        25014         2.00
       1.005     0.550000        27522         2.22
       1.056     0.600000        30040         2.50
       1.108     0.650000        32536         2.86
       1.158     0.700000        35026         3.33
       1.209     0.750000        37526         4.00
       1.235     0.775000        38750         4.44
       1.263     0.800000        40017         5.00
       1.293     0.825000        41272         5.71
       1.326     0.850000        42516         6.67
       1.363     0.875000        43780         8.00
       1.383     0.887500        44377         8.89
       1.406     0.900000        45000        10.00
       1.433     0.912500        45641        11.43
       1.461     0.925000        46265        13.33
       1.494     0.937500        46883        16.00
       1.514     0.943750        47185        17.78
       1.535     0.950000        47495        20.00
       1.562     0.956250        47819        22.86
       1.591     0.962500        48125        26.67
       1.625     0.968750        48435        32.00
       1.652     0.971875        48589        35.56
       1.680     0.975000        48750        40.00
       1.719     0.978125        48902        45.71
       1.789     0.981250        49059        53.33
       1.914     0.984375        49215        64.00
       2.006     0.985938        49291        71.11
       2.165     0.987500        49373        80.00
       2.287     0.989062        49449        91.43
       2.569     0.990625        49528       106.67
       2.899     0.992188        49604       128.00
       3.109     0.992969        49643       142.22
       3.473     0.993750        49682       160.00
       3.965     0.994531        49721       182.86
       4.355     0.995313        49760       213.33
       4.731     0.996094        49799       256.00
       5.111     0.996484        49819       284.44
       5.395     0.996875        49838       320.00
       6.067     0.997266        49858       365.71
       6.971     0.997656        49877       426.67
       7.903     0.998047        49897       512.00
       8.115     0.998242        49907       568.89
       8.271     0.998437        49916       640.00
       8.655     0.998633        49926       731.43
       9.375     0.998828        49936       853.33
      10.535     0.999023        49946      1024.00
      10.991     0.999121        49951      1137.78
      11.223     0.999219        49955      1280.00
      11.831     0.999316        49960      1462.86
      12.527     0.999414        49965      1706.67
      13.319     0.999512        49970      2048.00
      13.487     0.999561        49973      2275.56
      13.551     0.999609        49975      2560.00
      13.815     0.999658        49977      2925.71
      14.351     0.999707        49980      3413.33
      14.871     0.999756        49982      4096.00
      15.543     0.999780        49984      4551.11
      15.807     0.999805        49985      5120.00
      16.311     0.999829        49986      5851.43
      16.367     0.999854        49987      6826.67
      16.831     0.999878        49988      8192.00
      16.911     0.999890        49989      9102.22
      17.183     0.999902        49990     10240.00
      17.183     0.999915        49990     11702.86
      17.215     0.999927        49991     13653.33
      17.215     0.999939        49991     16384.00
      17.311     0.999945        49992     18204.44
      17.311     0.999951        49992     20480.00
      17.311     0.999957        49992     23405.71
      19.263     0.999963        49993     27306.67
      19.263     0.999969        49993     32768.00
      19.263     0.999973        49993     36408.89
      19.263     0.999976        49993     40960.00
      19.263     0.999979        49993     46811.43
      20.607     0.999982        49994     54613.33
      20.607     1.000000        49994          inf
#[Mean    =        0.997, StdDeviation   =        0.651]
#[Max     =       20.592, Total count    =        49994]
#[Buckets =           27, SubBuckets     =         2048]
----------------------------------------------------------
  60004 requests in 1.00m, 5.01MB read
Requests/sec:   1000.05
Transfer/sec:     85.54KB


2. НОДА НА ПОРТУ 8083

wrk -t4 -c4 -d60s -R1000 -s ./wrk/get.lua --latency http://localhost:8083
Running 1m test @ http://localhost:8083
  4 threads and 4 connections
  Thread calibration: mean lat.: 1.195ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.171ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.204ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.182ms, rate sampling interval: 10ms
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     1.01ms  717.98us  27.66ms   96.86%
    Req/Sec   264.18     55.32   666.00     53.76%
  Latency Distribution (HdrHistogram - Recorded Latency)
 50.000%    0.96ms
 75.000%    1.22ms
 90.000%    1.43ms
 99.000%    2.58ms
 99.900%   11.48ms
 99.990%   20.83ms
 99.999%   27.68ms
100.000%   27.68ms

  Detailed Percentile spectrum:
       Value   Percentile   TotalCount 1/(1-Percentile)

       0.120     0.000000            1         1.00
       0.500     0.100000         5004         1.11
       0.634     0.200000        10023         1.25
       0.748     0.300000        15021         1.43
       0.855     0.400000        20006         1.67
       0.960     0.500000        25021         2.00
       1.015     0.550000        27542         2.22
       1.067     0.600000        30005         2.50
       1.119     0.650000        32516         2.86
       1.170     0.700000        35028         3.33
       1.223     0.750000        37544         4.00
       1.251     0.775000        38755         4.44
       1.279     0.800000        40006         5.00
       1.309     0.825000        41255         5.71
       1.342     0.850000        42520         6.67
       1.379     0.875000        43768         8.00
       1.400     0.887500        44375         8.89
       1.432     0.900000        44999        10.00
       1.466     0.912500        45644        11.43
       1.494     0.925000        46248        13.33
       1.525     0.937500        46881        16.00
       1.543     0.943750        47203        17.78
       1.561     0.950000        47498        20.00
       1.584     0.956250        47811        22.86
       1.610     0.962500        48123        26.67
       1.647     0.968750        48437        32.00
       1.666     0.971875        48590        35.56
       1.694     0.975000        48749        40.00
       1.735     0.978125        48904        45.71
       1.792     0.981250        49059        53.33
       1.897     0.984375        49215        64.00
       2.022     0.985938        49292        71.11
       2.169     0.987500        49371        80.00
       2.375     0.989062        49449        91.43
       2.715     0.990625        49527       106.67
       2.997     0.992188        49605       128.00
       3.207     0.992969        49644       142.22
       3.379     0.993750        49683       160.00
       3.745     0.994531        49722       182.86
       4.131     0.995313        49761       213.33
       4.891     0.996094        49800       256.00
       5.547     0.996484        49820       284.44
       6.067     0.996875        49839       320.00
       6.755     0.997266        49859       365.71
       7.227     0.997656        49878       426.67
       8.019     0.998047        49898       512.00
       8.831     0.998242        49908       568.89
       9.543     0.998437        49917       640.00
      10.535     0.998633        49927       731.43
      11.039     0.998828        49937       853.33
      11.783     0.999023        49947      1024.00
      12.183     0.999121        49952      1137.78
      12.535     0.999219        49956      1280.00
      13.335     0.999316        49961      1462.86
      13.767     0.999414        49966      1706.67
      14.503     0.999512        49971      2048.00
      14.759     0.999561        49974      2275.56
      15.191     0.999609        49976      2560.00
      15.495     0.999658        49978      2925.71
      15.703     0.999707        49981      3413.33
      16.087     0.999756        49983      4096.00
      16.639     0.999780        49985      4551.11
      17.119     0.999805        49986      5120.00
      17.375     0.999829        49987      5851.43
      17.887     0.999854        49988      6826.67
      20.415     0.999878        49989      8192.00
      20.831     0.999890        49990      9102.22
      23.007     0.999902        49991     10240.00
      23.007     0.999915        49991     11702.86
      23.023     0.999927        49992     13653.33
      23.023     0.999939        49992     16384.00
      23.919     0.999945        49993     18204.44
      23.919     0.999951        49993     20480.00
      23.919     0.999957        49993     23405.71
      24.847     0.999963        49994     27306.67
      24.847     0.999969        49994     32768.00
      24.847     0.999973        49994     36408.89
      24.847     0.999976        49994     40960.00
      24.847     0.999979        49994     46811.43
      27.679     0.999982        49995     54613.33
      27.679     1.000000        49995          inf
#[Mean    =        1.009, StdDeviation   =        0.718]
#[Max     =       27.664, Total count    =        49995]
#[Buckets =           27, SubBuckets     =         2048]
----------------------------------------------------------
  60004 requests in 1.00m, 5.01MB read
Requests/sec:   1000.06
Transfer/sec:     85.55KB


3. НОДА НА ПОРТУ 8084:

wrk -t4 -c4 -d60s -R1000 -s ./wrk/get.lua --latency http://localhost:8084
Running 1m test @ http://localhost:8084
  4 threads and 4 connections
  Thread calibration: mean lat.: 1.022ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.034ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.025ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.025ms, rate sampling interval: 10ms
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     1.01ms  601.28us  17.01ms   91.91%
    Req/Sec   264.25     55.61   666.00     53.19%
  Latency Distribution (HdrHistogram - Recorded Latency)
 50.000%    0.97ms
 75.000%    1.23ms
 90.000%    1.43ms
 99.000%    2.42ms
 99.900%    9.06ms
 99.990%   16.54ms
 99.999%   17.02ms
100.000%   17.02ms

  Detailed Percentile spectrum:
       Value   Percentile   TotalCount 1/(1-Percentile)

       0.169     0.000000            2         1.00
       0.514     0.100000         5022         1.11
       0.642     0.200000        10025         1.25
       0.763     0.300000        15040         1.43
       0.868     0.400000        20009         1.67
       0.970     0.500000        25027         2.00
       1.019     0.550000        27517         2.22
       1.070     0.600000        30024         2.50
       1.120     0.650000        32529         2.86
       1.169     0.700000        35007         3.33
       1.231     0.750000        37510         4.00
       1.258     0.775000        38784         4.44
       1.286     0.800000        40018         5.00
       1.315     0.825000        41255         5.71
       1.348     0.850000        42517         6.67
       1.385     0.875000        43750         8.00
       1.406     0.887500        44374         8.89
       1.430     0.900000        45009        10.00
       1.456     0.912500        45637        11.43
       1.484     0.925000        46253        13.33
       1.518     0.937500        46872        16.00
       1.538     0.943750        47187        17.78
       1.561     0.950000        47509        20.00
       1.585     0.956250        47812        22.86
       1.614     0.962500        48129        26.67
       1.652     0.968750        48442        32.00
       1.678     0.971875        48593        35.56
       1.710     0.975000        48747        40.00
       1.757     0.978125        48907        45.71
       1.820     0.981250        49061        53.33
       1.934     0.984375        49214        64.00
       2.039     0.985938        49293        71.11
       2.183     0.987500        49371        80.00
       2.315     0.989062        49450        91.43
       2.525     0.990625        49527       106.67
       2.745     0.992188        49605       128.00
       2.931     0.992969        49644       142.22
       3.161     0.993750        49683       160.00
       3.535     0.994531        49723       182.86
       4.015     0.995313        49761       213.33
       4.451     0.996094        49800       256.00
       4.655     0.996484        49821       284.44
       4.915     0.996875        49839       320.00
       5.303     0.997266        49860       365.71
       5.639     0.997656        49878       426.67
       6.283     0.998047        49898       512.00
       6.683     0.998242        49908       568.89
       7.199     0.998437        49917       640.00
       7.907     0.998633        49927       731.43
       8.559     0.998828        49937       853.33
       9.119     0.999023        49947      1024.00
       9.623     0.999121        49952      1137.78
      10.023     0.999219        49956      1280.00
      10.359     0.999316        49961      1462.86
      10.887     0.999414        49966      1706.67
      12.143     0.999512        49971      2048.00
      12.783     0.999561        49974      2275.56
      12.959     0.999609        49976      2560.00
      13.303     0.999658        49978      2925.71
      13.527     0.999707        49981      3413.33
      14.055     0.999756        49983      4096.00
      14.415     0.999780        49985      4551.11
      15.127     0.999805        49986      5120.00
      15.351     0.999829        49987      5851.43
      15.631     0.999854        49988      6826.67
      15.687     0.999878        49989      8192.00
      16.543     0.999890        49990      9102.22
      16.607     0.999902        49991     10240.00
      16.607     0.999915        49991     11702.86
      16.639     0.999927        49992     13653.33
      16.639     0.999939        49992     16384.00
      16.719     0.999945        49993     18204.44
      16.719     0.999951        49993     20480.00
      16.719     0.999957        49993     23405.71
      16.975     0.999963        49994     27306.67
      16.975     0.999969        49994     32768.00
      16.975     0.999973        49994     36408.89
      16.975     0.999976        49994     40960.00
      16.975     0.999979        49994     46811.43
      17.023     0.999982        49995     54613.33
      17.023     1.000000        49995          inf
#[Mean    =        1.007, StdDeviation   =        0.601]
#[Max     =       17.008, Total count    =        49995]
#[Buckets =           27, SubBuckets     =         2048]
----------------------------------------------------------
  60004 requests in 1.00m, 5.01MB read
Requests/sec:   1000.04
Transfer/sec:     85.54KB


++++++++++++++++++++++++++++++++++++++++++PUT + GET 2/1++++++++++++++++++++++++++++++++++++++++++


Параллельно нагружаем три ноды одинаковыми нагрузками, но разными методами - 2 ноды отрабатывают метод PUT, третья - метод GET


1. НОДА на ПОРТУ 8085 (МЕТОД PUT)

wrk -t4 -c4 -d60s -R1000 -s ./wrk/put.lua --latency http://localhost:8085
Running 1m test @ http://localhost:8085
  4 threads and 4 connections
  Thread calibration: mean lat.: 1.029ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.032ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.027ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.024ms, rate sampling interval: 10ms
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     1.06ms  409.93us  15.22ms   74.39%
    Req/Sec   262.78     54.89   666.00     48.85%
  Latency Distribution (HdrHistogram - Recorded Latency)
 50.000%    1.05ms
 75.000%    1.30ms
 90.000%    1.50ms
 99.000%    1.79ms
 99.900%    4.19ms
 99.990%   11.69ms
 99.999%   15.23ms
100.000%   15.23ms

  Detailed Percentile spectrum:
       Value   Percentile   TotalCount 1/(1-Percentile)

       0.190     0.000000            1         1.00
       0.599     0.100000         5010         1.11
       0.731     0.200000        10018         1.25
       0.841     0.300000        15021         1.43
       0.938     0.400000        20012         1.67
       1.049     0.500000        25016         2.00
       1.101     0.550000        27539         2.22
       1.153     0.600000        30026         2.50
       1.205     0.650000        32503         2.86
       1.255     0.700000        35004         3.33
       1.305     0.750000        37523         4.00
       1.331     0.775000        38797         4.44
       1.362     0.800000        40019         5.00
       1.400     0.825000        41247         5.71
       1.431     0.850000        42541         6.67
       1.465     0.875000        43768         8.00
       1.482     0.887500        44397         8.89
       1.501     0.900000        45010        10.00
       1.523     0.912500        45648        11.43
       1.544     0.925000        46265        13.33
       1.568     0.937500        46878        16.00
       1.581     0.943750        47194        17.78
       1.596     0.950000        47512        20.00
       1.610     0.956250        47812        22.86
       1.627     0.962500        48125        26.67
       1.646     0.968750        48434        32.00
       1.657     0.971875        48590        35.56
       1.670     0.975000        48751        40.00
       1.683     0.978125        48907        45.71
       1.701     0.981250        49058        53.33
       1.720     0.984375        49214        64.00
       1.731     0.985938        49297        71.11
       1.749     0.987500        49372        80.00
       1.771     0.989062        49452        91.43
       1.799     0.990625        49529       106.67
       1.839     0.992188        49606       128.00
       1.869     0.992969        49645       142.22
       1.940     0.993750        49683       160.00
       2.036     0.994531        49722       182.86
       2.163     0.995313        49761       213.33
       2.325     0.996094        49800       256.00
       2.431     0.996484        49820       284.44
       2.511     0.996875        49839       320.00
       2.659     0.997266        49859       365.71
       2.785     0.997656        49878       426.67
       2.937     0.998047        49898       512.00
       3.059     0.998242        49908       568.89
       3.189     0.998437        49917       640.00
       3.379     0.998633        49927       731.43
       3.705     0.998828        49937       853.33
       4.287     0.999023        49947      1024.00
       4.679     0.999121        49952      1137.78
       4.935     0.999219        49956      1280.00
       5.495     0.999316        49961      1462.86
       5.923     0.999414        49966      1706.67
       6.615     0.999512        49971      2048.00
       6.719     0.999561        49974      2275.56
       6.883     0.999609        49976      2560.00
       7.199     0.999658        49978      2925.71
       7.939     0.999707        49981      3413.33
       8.399     0.999756        49983      4096.00
       9.159     0.999780        49986      4551.11
       9.159     0.999805        49986      5120.00
      10.095     0.999829        49987      5851.43
      10.311     0.999854        49988      6826.67
      10.575     0.999878        49989      8192.00
      11.687     0.999890        49990      9102.22
      11.775     0.999902        49991     10240.00
      11.775     0.999915        49991     11702.86
      12.151     0.999927        49992     13653.33
      12.151     0.999939        49992     16384.00
      12.247     0.999945        49993     18204.44
      12.247     0.999951        49993     20480.00
      12.247     0.999957        49993     23405.71
      13.551     0.999963        49994     27306.67
      13.551     0.999969        49994     32768.00
      13.551     0.999973        49994     36408.89
      13.551     0.999976        49994     40960.00
      13.551     0.999979        49994     46811.43
      15.231     0.999982        49995     54613.33
      15.231     1.000000        49995          inf
#[Mean    =        1.059, StdDeviation   =        0.410]
#[Max     =       15.224, Total count    =        49995]
#[Buckets =           27, SubBuckets     =         2048]
----------------------------------------------------------
  60004 requests in 1.00m, 4.75MB read
Requests/sec:   1000.05
Transfer/sec:     81.06KB





3. НОДА на ПОРТУ 8084 (Метод GET)

wrk -t4 -c4 -d60s -R1000 -s ./wrk/get.lua --latency http://localhost:8084
Running 1m test @ http://localhost:8084
  4 threads and 4 connections
  Thread calibration: mean lat.: 1.027ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.015ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.009ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.037ms, rate sampling interval: 10ms
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     1.04ms  420.88us  13.49ms   76.67%
    Req/Sec   262.61     54.35   500.00     50.74%
  Latency Distribution (HdrHistogram - Recorded Latency)
 50.000%    1.03ms
 75.000%    1.29ms
 90.000%    1.48ms
 99.000%    1.76ms
 99.900%    5.32ms
 99.990%   10.89ms
 99.999%   13.49ms
100.000%   13.49ms

  Detailed Percentile spectrum:
       Value   Percentile   TotalCount 1/(1-Percentile)

       0.145     0.000000            1         1.00
       0.583     0.100000         5015         1.11
       0.713     0.200000        10002         1.25
       0.823     0.300000        15020         1.43
       0.927     0.400000        20051         1.67
       1.027     0.500000        25004         2.00
       1.078     0.550000        27500         2.22
       1.129     0.600000        30025         2.50
       1.183     0.650000        32534         2.86
       1.234     0.700000        35039         3.33
       1.286     0.750000        37503         4.00
       1.313     0.775000        38751         4.44
       1.343     0.800000        40012         5.00
       1.373     0.825000        41282         5.71
       1.403     0.850000        42500         6.67
       1.438     0.875000        43753         8.00
       1.458     0.887500        44406         8.89
       1.476     0.900000        44999        10.00
       1.497     0.912500        45625        11.43
       1.520     0.925000        46254        13.33
       1.544     0.937500        46875        16.00
       1.558     0.943750        47192        17.78
       1.573     0.950000        47498        20.00
       1.589     0.956250        47821        22.86
       1.607     0.962500        48128        26.67
       1.626     0.968750        48431        32.00
       1.636     0.971875        48587        35.56
       1.650     0.975000        48755        40.00
       1.664     0.978125        48902        45.71
       1.682     0.981250        49068        53.33
       1.701     0.984375        49221        64.00
       1.714     0.985938        49293        71.11
       1.732     0.987500        49371        80.00
       1.751     0.989062        49451        91.43
       1.776     0.990625        49526       106.67
       1.809     0.992188        49605       128.00
       1.839     0.992969        49642       142.22
       1.897     0.993750        49682       160.00
       1.969     0.994531        49720       182.86
       2.131     0.995313        49760       213.33
       2.293     0.996094        49799       256.00
       2.385     0.996484        49818       284.44
       2.513     0.996875        49837       320.00
       2.661     0.997266        49857       365.71
       2.821     0.997656        49877       426.67
       3.227     0.998047        49896       512.00
       3.527     0.998242        49906       568.89
       3.727     0.998437        49915       640.00
       4.219     0.998633        49925       731.43
       4.759     0.998828        49935       853.33
       5.467     0.999023        49945      1024.00
       5.703     0.999121        49950      1137.78
       5.871     0.999219        49954      1280.00
       6.059     0.999316        49959      1462.86
       6.891     0.999414        49964      1706.67
       7.375     0.999512        49969      2048.00
       7.555     0.999561        49972      2275.56
       7.787     0.999609        49974      2560.00
       8.631     0.999658        49976      2925.71
       9.167     0.999707        49979      3413.33
       9.359     0.999756        49981      4096.00
       9.607     0.999780        49983      4551.11
       9.743     0.999805        49984      5120.00
       9.759     0.999829        49985      5851.43
       9.895     0.999854        49986      6826.67
      10.103     0.999878        49987      8192.00
      10.887     0.999890        49988      9102.22
      11.935     0.999902        49989     10240.00
      11.935     0.999915        49989     11702.86
      12.775     0.999927        49990     13653.33
      12.775     0.999939        49990     16384.00
      12.919     0.999945        49991     18204.44
      12.919     0.999951        49991     20480.00
      12.919     0.999957        49991     23405.71
      13.007     0.999963        49992     27306.67
      13.007     0.999969        49992     32768.00
      13.007     0.999973        49992     36408.89
      13.007     0.999976        49992     40960.00
      13.007     0.999979        49992     46811.43
      13.495     0.999982        49993     54613.33
      13.495     1.000000        49993          inf
#[Mean    =        1.040, StdDeviation   =        0.421]
#[Max     =       13.488, Total count    =        49993]
#[Buckets =           27, SubBuckets     =         2048]
----------------------------------------------------------
  60004 requests in 1.00m, 5.01MB read
Requests/sec:   1000.04
Transfer/sec:     85.54KB

3. НОДА на ПОРТУ 8083 (МЕТОД PUT)

wrk -t4 -c4 -d60s -R1000 -s ./wrk/put.lua --latency http://localhost:8083
Running 1m test @ http://localhost:8083
  4 threads and 4 connections
  Thread calibration: mean lat.: 1.088ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.059ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.038ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.028ms, rate sampling interval: 10ms
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     1.03ms  399.67us  13.54ms   74.60%
    Req/Sec   262.69     54.96   555.00     48.95%
  Latency Distribution (HdrHistogram - Recorded Latency)
 50.000%    1.03ms
 75.000%    1.28ms
 90.000%    1.46ms
 99.000%    1.74ms
 99.900%    4.83ms
 99.990%    9.90ms
 99.999%   13.55ms
100.000%   13.55ms

  Detailed Percentile spectrum:
       Value   Percentile   TotalCount 1/(1-Percentile)

       0.178     0.000000            1         1.00
       0.585     0.100000         5010         1.11
       0.718     0.200000        10024         1.25
       0.821     0.300000        15016         1.43
       0.922     0.400000        20031         1.67
       1.026     0.500000        25032         2.00
       1.076     0.550000        27506         2.22
       1.127     0.600000        30042         2.50
       1.177     0.650000        32522         2.86
       1.228     0.700000        34997         3.33
       1.281     0.750000        37534         4.00
       1.308     0.775000        38786         4.44
       1.334     0.800000        40013         5.00
       1.362     0.825000        41279         5.71
       1.391     0.850000        42513         6.67
       1.423     0.875000        43762         8.00
       1.440     0.887500        44376         8.89
       1.459     0.900000        44996        10.00
       1.480     0.912500        45641        11.43
       1.503     0.925000        46254        13.33
       1.527     0.937500        46889        16.00
       1.539     0.943750        47194        17.78
       1.553     0.950000        47509        20.00
       1.567     0.956250        47809        22.86
       1.586     0.962500        48127        26.67
       1.606     0.968750        48442        32.00
       1.616     0.971875        48591        35.56
       1.629     0.975000        48749        40.00
       1.645     0.978125        48909        45.71
       1.662     0.981250        49069        53.33
       1.679     0.984375        49216        64.00
       1.692     0.985938        49292        71.11
       1.706     0.987500        49371        80.00
       1.726     0.989062        49450        91.43
       1.751     0.990625        49527       106.67
       1.788     0.992188        49606       128.00
       1.821     0.992969        49644       142.22
       1.863     0.993750        49684       160.00
       1.925     0.994531        49722       182.86
       2.024     0.995313        49761       213.33
       2.191     0.996094        49802       256.00
       2.257     0.996484        49820       284.44
       2.357     0.996875        49839       320.00
       2.507     0.997266        49859       365.71
       2.791     0.997656        49878       426.67
       3.083     0.998047        49898       512.00
       3.393     0.998242        49908       568.89
       3.555     0.998437        49917       640.00
       3.755     0.998633        49927       731.43
       4.367     0.998828        49937       853.33
       4.939     0.999023        49948      1024.00
       5.079     0.999121        49952      1137.78
       5.599     0.999219        49956      1280.00
       5.811     0.999316        49961      1462.86
       6.287     0.999414        49966      1706.67
       6.499     0.999512        49971      2048.00
       7.039     0.999561        49974      2275.56
       7.203     0.999609        49976      2560.00
       7.455     0.999658        49978      2925.71
       7.643     0.999707        49981      3413.33
       7.691     0.999756        49983      4096.00
       7.951     0.999780        49985      4551.11
       7.971     0.999805        49986      5120.00
       8.719     0.999829        49987      5851.43
       9.231     0.999854        49988      6826.67
       9.775     0.999878        49989      8192.00
       9.903     0.999890        49990      9102.22
      10.151     0.999902        49991     10240.00
      10.151     0.999915        49991     11702.86
      11.135     0.999927        49992     13653.33
      11.135     0.999939        49992     16384.00
      11.759     0.999945        49993     18204.44
      11.759     0.999951        49993     20480.00
      11.759     0.999957        49993     23405.71
      12.551     0.999963        49994     27306.67
      12.551     0.999969        49994     32768.00
      12.551     0.999973        49994     36408.89
      12.551     0.999976        49994     40960.00
      12.551     0.999979        49994     46811.43
      13.551     0.999982        49995     54613.33
      13.551     1.000000        49995          inf
#[Mean    =        1.034, StdDeviation   =        0.400]
#[Max     =       13.544, Total count    =        49995]
#[Buckets =           27, SubBuckets     =         2048]
----------------------------------------------------------
  60004 requests in 1.00m, 4.75MB read
Requests/sec:   1000.06
Transfer/sec:     81.06KB
